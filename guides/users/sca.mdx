---
title: SCA on Owner users
sidebarTitle: Introduction
---

import Emi from '/snippets/glossary/emi.mdx';

Mangopay is implementing **strong customer authentication** (SCA) on your platform's users to enhance security and to comply with European regulations (PSD2) as a regulated <Emi content="[EMI](/guides/glossary#electronic-money-institution-emi)" />. The same regulations are behind 3DS authentication applied to card payments or alternative requirements for other payment methods.

SCA is a form of multi-factor authentication (MFA, also 2FA), where a user authenticates using evidence of different categories (knowledge, possession, and inherence).

## Scope

<Note>
**Note – SCA applies to users Owner only**

Mangopay's SCA feature will only apply to users categorized as Owner, because these users are subject to Mangopay's T&Cs and as such hold a **Mangopay account**.

Users categorized as Payers will not be affected by Mangopay's SCA.
</Note>

SCA requires the Owner user to authenticate with Mangopay directly as they are the Mangopay account holder.

For **Natural users**, enrollment of the **OTP factor** is available to integrate, requiring the individual's `PhoneNumber` and `Email`.

For Legal users, enrollment of the **OTP factor** is available to integrate for **Soletraders**. The individual's phone number and email must be provided in `LegalRepresentative.PhoneNumber` and `LegalRepresentative.Email` and they must authenticate.  

In future, Mangopay will provide features to allow the other types of Legal user (Business, Organization, Partnership) to designate additional **authorized individuals** who can complete SCA on behalf of the entity.

## What your platform needs to do

Your platform needs to integrate the new user endpoints to handle SCA in the following scenarios for Owner users.

The dedicated enrollment guides linked below provide a step-by-step walkthrough of each case:

<table>
<thead>
<tr>
<th class="header"></th>
<th class="header">Action</th>
<th class="header">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="table-content">
1
</td>
<td class="table-content">
Enrollment of new Owners (Natural and Legal Soletraders) users using OTP authentication when you **register them for the first time** (at user creation)
</td>
<td class="table-content">
[Register a Owner user for the first time](/guides/users/sca/enrollment#register-an-owner-for-the-first-time)
</td>
</tr>
<tr>
<td class="table-content">
2
</td>
<td class="table-content">
Enrollment of Owners (Natural and Legal Soletraders) users using OTP authentication when they **transition from a Payer** (on categorization)
</td>
<td class="table-content">
[Transition an existing Payer to Owner](/guides/users/sca/enrollment#transition-an-existing-payer-to-owner)
</td>
</tr>
<tr>
<td class="table-content">
3
</td>
<td class="table-content">
**Enrollment of all existing** Owners (Natural and Legal Soletraders) users in OTP authentication
</td>
<td class="table-content">
[Enroll an existing Owner](/guides/users/sca/enrollment#enroll-an-existing-owner)
</td>
</tr>
<tr>
<td class="table-content">
4
</td>
<td class="table-content">
Re-enrollment of Owners (Natural and Legal Soletraders) users when they change the phone number or email.
</td>
<td class="table-content">
[Re-enroll a User](/guides/users/sca/enrollment#re-enroll-a-owner-user)
</td>
</tr>
</tbody>
</table> 

In all cases, to enroll the user your platform must redirect the individual to a Mangopay-hosted webpage. The redirection URL for the SCA session is returned by the Mangopay API in the response property `PendingUserAction.RedirectUrl`. Before redirecting, you need to define, encode, and append a `returnUrl` to which the session returns the user afterwards (whatever the outcome). 

See the [SCA session](/guides/users/sca/session) guide for details on this redirection process. Mangopay will use the same mechanism for all SCA-related features, both enrollment and authentication of planned features.

<Check>
**Best practice – Anticipate integration**

Your platform will be required to complete additional integration during 2025 as Mangopay releases new SCA-related features.

More details about Mangopay's planned features for [SCA-controlled actions](/#sca-controlled-actions) are listed in the table below.
</Check>

## Factors

Mangopay is providing the following authentication factors.



The regulations apply SCA to situations where a user accesses or initiates certain payment activities, or to other situations considered at-risk.

For Mangopay, this means that the scope of SCA will be extended over time.

#### Current scope - Enrollment

In the first instance, Mangopay's SCA feature implements the enrollment of the user, meaning they register device details and authenticate them. 

- Registration as as Owner

The user can be created as an Owner to transition to Owner from Payer: both cases require SCA.

The enrollment is delivered in an [SCA session](#sca-session) that they can access via the `RedirectUrl` returned by the Mangopay API. This means your platform must redirect the user to a Mangopay-hosted experience before they can access Mangopay features as an Owner.

See the dedicated [enrollment guide](/guides/users/sca/enrollment) for details about SCA scenarios during user registration.

#### Future scope - Authentication

In future, Mangopay's SCA feature will also be applied to:

- Bank account registration
- Wallet access
- Transfer initiation

When these actions are requested, the user would be required to authenticate.

For platforms, authentication works in the same way as enrollment: you must redirect the user to a Mangopay-hosted SCA session before the requested action can be delivered.

## SCA session

Mangopay's SCA feature relies on Mangopay-hosted web page where the user can enroll or authenticate.

To deliver this SCA session, Mangopay provides a unique URL in the `RedirectUrl` response parameter on relevant actions across its API. The `RedirectUrl` is returned as part of the `PendingUserAction` response object.

### Authentication factors

#### SMS one-time passcode (OTP)

In a first instance, authentication is done via **one-time passcode (OTP)**. Other methods will be developed in future, all relying on the same `RedirectUrl`.

In OTP authentication, the SCA session provides the user a screen where they can provide their phone number (if not already supplied by the platform), request an OTP by SMS, and submit it.

<img src="/images/screenshot_sca_otp.png" />

#### Testing SMS OTP

In Sandbox, you can test the SMS OTP by using a real phone number as the `PhoneNumber` field in the user object. 

Alternatively, you can use +33611111111 and the passcode 702100 to simulate a successful flow.

### How to redirect a user for SCA

This section describes how to handle the SCA redirection when required by an SCA scenario.

<Steps>
<Step title="Call an endpoint that triggers SCA">
Your platform needs to redirect the user for SCA authentication when you take one of the following actions and call the relevant endpoint: 
- Create an Owner user by calling [POST Create a Natural User (SCA)](/api-reference/users/create-natural-user-sca) or [POST Create a Legal User (SCA)](/api-reference/users/create-legal-user-sca) and setting `UserCategory` to `OWNER`
- Transition an existing Payer to Owner by calling [PUT Categorize a Natural User](/api-reference/users/categorize-natural-user) or [POST Categorize a Legal User](/api-reference/users/categorize-legal-user) and setting `UserCategory` to `OWNER`
- Obtain a new SCA redirection link by calling [POST Enroll a User](/api-reference/users/enroll-user), if a previous authentication attempt was unsuccessful or the session timed out
- Modify the SCA contact details of an already enrolled Owner user by sending new `PhoneNumber` and `Email` to [PUT Update a Natural User (SCA)](/api-reference/users/update-natural-user-sca) or `LegalRepresentative.PhoneNumber` and `LegalRepresentative.Email` to [PUT Update a Legal User (SCA)](/api-reference/users/update-legal-user-sca)

See the dedicated [enrollment guide](/guides/users/sca/enrollment) for details about SCA scenarios during user registration.
</Step>
<Step title="Retrieve the SCA RedirectUrl">

In the API response from an endpoint triggering SCA, the `PendingUserAction` object contains a `RedirectUrl` value. For example:

```json
{
...
	"PendingUserAction": {
		"RedirectUrl": "https://sca.mangopay.com?token=0193d02f30df7a188c51cf890a191d21"
    },
...
}
```

The URL of the unique SCA session is:

<table>
<tbody>
<tr>
<td class="table-content no-borders">
https<span>://</span>sca.mangopay.com?&#8288;token=0193d02f30df7a188c51cf890a191d21
</td>
</tr>
</tbody>
</table> 

</Step>
<Step title="Add your returnUrl and redirect the user">
Define a `returnUrl` to which the user will be returned after they authenticate on the Mangopay-hosted page, regardless of the outcome. 

Append your URL to the `RedirectUrl` response value as a query parameter, being sure to percent-encode any non-ASCII characters. 

Redirect the user on the new URL string which now comprises Mangopay's full `RedirectUrl` response value and your added `returnUrl`.

For example, if your `returnUrl` is <span>https:</span>//example.com, you should redirect the user on:

<table>
<tbody>
<tr>
<td class="table-content no-borders">
<span>https:</span>//sca.mangopay.com?&#8288;token=0193d02f30df7a188c51cf890a191d21&returnUrl=https%3A%2F%2Fexample.com
</td>
</tr>
</tbody>
</table> 

<Warning>
**Caution – Add your return URL before redirection**

You must add your `returnUrl` before you redirect the user on the `RedirectUrl` value, otherwise the hosted web page cannot return them upon completion.

The `returnUrl` parameter name is case-sensitive. 
</Warning>

Note that the concatenation of Mangopay's `RedirectUrl` and your encoded `returnUrl` must be less than 2,000 characters, which is the limit of most web browsers.
</Step>
<Step title="Let the user authenticate">
Once on the `RedirectUrl`, the user can perform the necessary actions for SCA. 

For the OTP authentication method, this means requesting and submitting a code via SMS. 

<Note>
**Note – Session timeout after 5 minutes**

The session of the `RedirectUrl` is valid for 5 minutes. If the user does not submit a successful SMS OTP before this time, the session can no longer be used and they are returned on your return URL.

If this happens, you need to obtain a new `RedirectUrl` for them using the endpoint [POST Enroll a User](/api-reference/users/enroll-user).
</Note>
</Step>
<Step title="Retrieve the returnUrl query parameters">

Once the user completes authentication (successfully or not) they are redirected to your `returnUrl`.

On redirection, Mangopay adds two query parameters to your `returnUrl`: `controlStatus` and `actionStatus`. 

For example:

<table>
<tbody>
<tr>
<td class="table-content no-borders">
<span>https:</span>//example.com/?controlStatus=VALIDATED&actionStatus=SUCCEEDED
</td>
</tr>
</tbody>
</table> 

</Step>
<Step title="Check the status of the user and the action">

The `controlStatus` parameter indicates the values of the control: 
- `VALIDATED` - The control was successful.
- `FAILED` - The control was unsuccessful and cannot be reused.

If the `controlStatus` is **not** `VALIDATED`, call the [POST Enroll a User](/api-reference/users/enroll-user) to obtain a new SCA `RedirectUrl` and retry the authentication session. 

The `actionStatus` parameter indicates the status of the action being controlled: 
- `SUCCEEDED` - The action was successful.
- `FAILED` - The action was not determined to be successful by the session or the outcome was otherwise unknown.

If the `actionStatus` is **not** `SUCCEEDED`, call the [GET View a User](/api-reference/users/view-user) to check the `UserStatus` of the user. If it is still `PENDING_USER_ACTION`, then call the [POST Enroll a User](/api-reference/users/enroll-user) to retry the authentication. 
</Step>
</Steps>

## Related resources

<CardGroup cols={2}>
<Card
  title="Guide"
  href="/guides/users/sca/session"
>
Read more about redirecting users for an SCA session
</Card>
<Card
  title="Guide"
  href="/guides/users/sca/enrollment"
>
Read about enrollment scenarios in the user lifecycle
</Card>
</CardGroup>