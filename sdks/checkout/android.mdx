---
title: 'Checkout - Android'  
sidebarTitle: 'Android'  
'og:description': 'How to set up the Mangopay Checkout SDK on Android, including handling 3DS redirection, payment result verification, and offering Google Pay.'  
---

This guide helps you get started with the Checkout SDK on Android.  

<Info>  
**Prerequisites**

- A `ClientId` and an API key ‚Äì if you don't have these, <a href="https://mangopay.com/contact" target="_blank">contact Sales</a> to get access to the <a href="https://hub.mangopay.com/" target="_blank">Mangopay Dashboard</a>
- A User and their associated Wallet to complete the pay-in  
- A card to register or payment method setup (see <a href="/testing/payment-methods">Testing - Payment methods</a> for testing information)  

For Android:¬†  
- Android `minSdk = 21`
</Info>  

<Check>
**Best practice ‚Äì Check out our example app and demo**

To support you with your integration, be sure to make use of our <a href="https://github.com/Mangopay/mangopay-checkout-android/tree/main/example" target="_blank">example app</a> on GitHub.
</Check>

## Installation  

The Mangopay Checkout SDK is published as a Maven artifact on <a href="https://central.sonatype.com/artifact/com.mangopay.android/checkout-sdk">Maven Central Repository</a>.  

Add the following code to your `app/build.gradle` file:  
```kotlin 
repositories {
  mavenCentral()
}

dependencies {
   implementation("com.mangopay.android:checkout-sdk:<latest-version>")
}
``` 

(Optional) To enable Nethone Profiler, add the following to now require the following to be added to the `settings.gradle.kts`.
```
maven {
    url = uri("https://nethone.jfrog.io/artifactory/nethonesdk-android-mangopay/")
}
```

## Initialize the SDK
Initialize the SDK and specify the configuration options.
<aside>
üö® The Initialization should only be done once for an instance of the application, We recommend putting this inside the `Application()` class.
</aside>

```kotlin
MangopaySdk.initialize(
    context = this,
    clientId = ‚ÄúclientId‚Äù,
    profilingMerchantId = ‚ÄúprofilingMerchantId‚Äù,
    tenantId = TenantId.EU,
    environment = Environment.SANDBOX,
    logLevel = LogLevel.Basic
)
```

### Initialization parameters
<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content"> `context` </td>
            <td class="table-content"> Application </td>
            <td class="table-content"> Application Context </td>
        </tr>
        <tr>
            <td class="table-content"> `clientId` </td>
            <td class="table-content"> String </td>
            <td class="table-content"> Your Mangopay `clientId` </td>
        </tr>
        <tr>
            <td class="table-content"> `profilingMerchantId` </td>
            <td class="table-content"> Int </td>
            <td class="table-content"> The unique identifier associated with your fraud protection package. <br/>Contact Mangopay to obtain this value.</td>
        </tr>
        <tr>
            <td class="table-content"> `environment` </td>
            <td class="table-content"> Environment </td>
            <td class="table-content"> Expected backend environment. 
                <br/><br/> Default value: `Environment.SANDBOX` <br/><br/> Allowed values:`Environment.SANDBOX`, `Environment.PRODUCTION`</td>
        </tr>
        <tr>
            <td class="table-content"> `logLevel` </td>
            <td class="table-content"> LogLevel </td>
            <td class="table-content"> Use this to specify HTTP request and response log. We recommend `LogLevel.None` for Production build. 
                <br/><br/> Default value: `LogLevel.None` <br/> Allowed values: `LogLevel.None` , `LogLevel.Basic` </td>
        </tr>
        <tr>
            <td class="table-content"> `tenantId` </td>
            <td class="table-content"> TenantId </td>
            <td class="table-content"> TenantId.EU or TenantId.UK </td>
        </tr>
    </tbody>
</table>

## Configure and present the PaymentSheet
<aside>
‚ÑπÔ∏è **Note ‚Äì Checkout SDK integrates fraud prevention profiler**

Mangopay‚Äôs fraud prevention profiler is built in to the Checkout SDK.

The `profilingMerchantId` is optional to initialize the Checkout SDK, 

`onTokenizationComplete` and `onCreatePayment` events will produce a `profilingAttemptReference` which is a unique identifier of the profiling attempt.

Subscribed platforms using the profiler can send this in as the `ProfilingAttemptReference` on all relevant API calls to leverage the profiler data in the fraud prevention solution. 

For more information, see the [Fraud prevention](https://mangopay.com/docs/concepts/fraud-prevention) article.

</aside>

### 1.2 Card Options Configuration

```kotlin
val cardOptions = CardOptions.Builder()
                    .supportedCardSchemes(
                        listOf(CardScheme.Maestro,CardScheme.MasterCard,CardScheme.Visa,)
                    )
                    .build()
```

Card Options Configuration Parameters
<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content"> `supportedCardSchemes` </td>
            <td class="table-content"> List\<Card> </td>
            <td class="table-content"> Card schemes to be shown for Card Payment option </td>
        </tr>
        <tr>
            <td class="table-content"> `cardRegistration` </td>
            <td class="table-content"> CardRegistration? </td>
            <td class="table-content"> You can provide CardRegistration optionally from configuration or provide it from callbacks </td>
        </tr>
    </tbody>
</table>

## 1.3 (Optional) GooglePay Configuration Options

To accept Google Pay payments with Mangopay PaymentSheet, when creating an instance of the Checkout class, you can optionally include a `GooglePayOptions` object. This will display the GooglePay button in your payment form and handle the GooglePay tokenization process.

You will need to pass the GooglePay payment data provided by the Checkout to your Google PayIn request from your backend. 

For more information, please refer to the [PayIn with GooglePay tutorial in the Mangopay documentation ‚Üí](https://mangopay.com/docs/tutorials/integration-guide-googlepay)

1. Configure TransactionInfo Object 
2. Create GooglePay Object
3. Configure GooglePayObject for GooglePay

```kotlin

val transactionInfo = TransactionInfo.Builder()
        .currencyCode("EUR")
        .countryCode("FI")
        .totalPriceStatus(TotalPriceStatus.FINAL)
        .totalPrice(5000.0)
        .transactionId(UUID.randomUUID().toString())
        .build()

val cardParameters = CardParameters.Builder()
       .allowedAuthMethods(listOf("PAN_ONLY", "CRYPTOGRAM_3DS"))
       .allowedCardNetworks(listOf( "MASTERCARD", "VISA"))
       .build()

val googlePayObject = GooglePayObject.Builder()
        .merchantName("Example Test")
        .gatewayMerchantId("your-mangopay-client-id")  
        .transactionInfo(transactionInfo)
        .cardParameters(cardParameters)
        .build()

val googlePayOptions = GooglePayOptions.Builder()
        .googlePayObject(googlePayObject)
        .build()
```
### GooglePay Parameters

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`gatewayMerchantId`</td>
            <td class="table-content">String</td>
            <td class="table-content">Your Mangopay `ClientId`.</td>
        </tr>
        <tr>
            <td class="table-content">`transactionInfo`</td>
            <td class="table-content">TransactionInfo</td>
            <td class="table-content">Information about the transaction. For more information on this object parameter, see the <a href="https://developers.google.com/pay/api/android/reference/request-objects#TransactionInfo" target="_blank">Google Pay documentation</a>.</td>
        </tr>
        <tr>
            <td class="table-content">`cardParameters`</td>
            <td class="table-content">CardParameters</td>
            <td class="table-content">Information about the card used for the payment.</td>
        </tr>
    </tbody>
</table>

#### `CardParameters` required parameters 

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`allowedAuthMethods`</td>
            <td class="table-content">List\<String></td>
            <td class="table-content">The supported authentication methods: **PAN_ONLY**, meaning the card is registered in the user‚Äôs Google account and requires additional authentication; **CRYPTOGRAM_3DS**, meaning the card is enrolled in the customer‚Äôs Google Wallet and authentication is handled by Google, with no 3DS redirection and no liability for the platform.\
                **Allowed values:** PAN_ONLY, CRYPTOGRAM_3DS</td>
        </tr>
        <tr>
            <td class="table-content">`allowedCardNetworks`</td>
            <td class="table-content">List</td>
            <td class="table-content">The card networks supported by Mangopay: VISA and MASTERCARD.\
                **Allowed values:** VISA, MASTERCARD</td>
        </tr>
    </tbody>
</table> 

#### `TransactionInfo` required parameters

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`countryCode`</td>
            <td class="table-content">String</td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`currencyCode`</td>
            <td class="table-content">String</td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`totalPriceStatus`</td>
            <td class="table-content">TotalPriceStatus</td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`totalPrice`</td>
            <td class="table-content">Double</td>
            <td class="table-content"></td>
        </tr>
    </tbody>
</table> 

## 1.4 (Optional) Paypal Options Configuration

```kotlin
val paypalOptions = PaypalOptions.Builder()
          .buttonOptions(buttonOptions)
          .build()
```

### Paypal Options Configuration Parameters

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`buttonOptions`</td>
            <td class="table-content">PaymentButtonOptions</td>
            <td class="table-content"></td>
        </tr>
    </tbody>
</table> 

## 1.5 Amount Options Configuration

```kotlin
val amount = Amount.Builder()
        .value(200.00)
        .currency(Currency.EUR)
        .build()
```

### Amount Options Configuration Parameters

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`value`</td>
            <td class="table-content">Double</td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`currency`</td>
            <td class="table-content">Currency</td>
            <td class="table-content"></td>
        </tr>
    </tbody>
</table> 

## 2. Configure `paymentSheet` with callback `listener`

```kotlin

    private fun paymentSheetCallbacks() = object : Mangopay.PaymentSheetResultListener {
        override fun onTokenizationCompleted(paymentMethod: PaymentMethod?, profilerAttemptReference: String?) {

            when (paymentMethod) {
                is PaymentMethod.CARD -> TODO()
                is PaymentMethod.GOOGLE_PAY -> TODO()
                else -> TODO()
            }
        }

        override fun onPaymentCompleted(id: String?, resultCode: ResultCode) {
            
        }

        override fun onPaymentMethodSelected(paymentMethod: PaymentMethod) {
            
        }

        override suspend fun onCreatePayment(paymentMethod: PaymentMethod, profilerAttemptReference: String?): Payment? {
            return when(paymentMethod){
                is PaymentMethod.PAYPAL -> TODO()
                is PaymentMethod.CARD -> TODO()
                is PaymentMethod.GOOGLE_PAY -> TODO()
                is GooglepayObject -> TODO()
            }
        }

        override suspend fun onCreateCardRegistration(card: Card): CardRegistration {
            
        }

        override fun onError(exception: MangopayException?) {

        }

        override fun onCancel() {

        }
    }
```

### PaymentSheet Callbacks

<table>
    <thead>
        <tr>
            <th class="header">Callback</th>
            <th class="header">Description</th>
            <th class="header">Argument</th>
            <th class="header">Return Type </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`onTokenizationCompleted(paymentMethod: PaymentMethod?, profilerAttemptReference: String?)`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`onPaymentCompleted(id: String?, resultCode: ResultCode)`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content"> `onPaymentMethodSelected(paymentMethod: PaymentMethod)`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content"> `onCreatePayment(paymentMethod: PaymentMethod, profilerAttemptReference: String?): Payment?`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content">`Payment?`</td>
        </tr>
        <tr>
            <td class="table-content">`onCreateCardRegistration(card: Card): CardRegistration?`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content">`CardRegistration?`</td>
        </tr>
        <tr>
            <td class="table-content">`onError(exception: MangopayException?)`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content"></td>
        </tr>
        <tr>
            <td class="table-content">`onCancel()`</td>
            <td class="table-content"></td>
            <td class="table-content"></td>
            <td class="table-content"></td>
        </tr>
    </tbody>
</table>

## 2.1  **Create and Present the Paymentsheet**

1. Put all the configurations together in `PaymentMethodOptions`
2. Add `PaymentMethodOptions`, the Callbacks and Display the PaymentSheet

```kotlin
// Putting everything (all the configurations) together
val paymentMethodOptions = PaymentMethodOptions.Builder()
        .cardOptions(cardOptions)
        .googlePayOptions(googlePayOptions) // OPTIONAL
        .paypalOptions(paypalOptions) // OPTIONAL
        .amount(amount)
        .build()
        
MangopayCheckoutSdk.create(
    mContext = this,
    paymentMethodOptions = paymentMethodOptions, 
    listener = paymentSheetCallbacks()
) 
```

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
            <th class="header">Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">`mContext`</td>
            <td class="table-content">Activity / Fragment</td>
            <td class="table-content">Activity or Fragment Context</td>
        </tr>
        <tr>
            <td class="table-content">`paymentMethodOptions`</td>
            <td class="table-content">PaymentMethodOptions</td>
            <td class="table-content">Configuration Parameters</td>
        </tr>
        <tr>
            <td class="table-content">`listener`</td>
            <td class="table-content">Mangopay.PaymentSheetResultListener</td>
            <td class="table-content">Callback Listeners</td>
        </tr>
    </tbody>
</table>

<Info>
    The payment sheet automatically closes when events are emitted to prevent users from clicking again.  
</Info>


## 2.2 **Handling redirection**

<aside>
‚ö†Ô∏è **Warning ‚Äì Use Mangopay Checkout domain as return URL**

When making the pay-in request from your backend, use the Mangopay Checkout URL as the `SecureModeReturnURL` or `ReturnURL` (depending on the payment method):

- `https://checkout.mangopay.com`

The user must be returned to this URL after redirection. 

</aside>

Some payment methods (card, Google Pay) require or may require the user to be redirected to authorize or complete a transaction.

The Checkout SDK allows you to manage the entire payment flow seamlessly while retaining control over transaction logic in your backend. Once a payment method is selected and payment details are provided, use the `onCreatePayment()` function to request the transaction from your backend.

Subsequently, and when necessary for the transaction type, the Checkout SDK seamlessly manages additional redirect actions for 3DS authorization or otherwise validating the payment.

## 3. Using Card Element  

<Info>
    The Card Element is a standalone component that offers a ready-made component that allows you to create your own card payment experience and tokenize card payment details. With our Card Element, you can easily incorporate a custom pay button and have control over the tokenization process.
    <br/> When using Card Element, you still benefit from real-time card data validation, and the ability to customize the payment form.
</Info>  

#### 3.1. Add the payment form to the intended layout  
```xml 
<com.mangopay.android.checkout.view.PaymentFormView
            android:id="@+id/payment_form"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            app:mangopay_elementBorderLineType="rectangle" />


<!-- Add custom pay button -->
<Button
            android:id="@+id/btn_pay"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:visibility="visible"
            android:layout_below="@+id/payment_form"
            android:layout_marginTop="50dp"
            android:text="Pay" />
```  

#### 3.2. Create the Card Registration as described above  
```kotlin 
val cardRegistration = CardRegistration.Builder()
        .id("Id")
        .userId("UserId")
        .accessKey("AccessKey")
        .preRegistrationData("PreRegistration")
        .cardRegistrationURL("CardRegistrationURL")
        .build()
```  

#### 3.3. Tokenize the card with the paymentForm object  
```kotlin 

//Find and connect PaymentFormView from Java/Kotlin code
val paymentForm = findViewById<PaymentFormView>(R.id.payment_form)
val payButton = findViewById<PaymentFormView>(R.id.btn_pay)


// tokenize card with the paymentForm object.
 payButton.setOnClickListener {
   
    //check if the paymentForm passed validation
    if(paymentForm.isComplete()){

            MangopayCheckoutSdk.tokenizeCard(
     paymentForm.toCardRequest(), cardRegistration,
       this@PaymentFormActivity, object: Mangopay.CheckoutTokenizeCardResultCallback {

             override fun success(result: CardResult?, attemptReference: String?) {
                 //process payment in your backend
             }
             override fun error(exception: MangopayException) {
                 //show error to shopper 
             }
           }
        )
    }
 }
```  

## 4.  Verify payment result
<aside>
‚ö†Ô∏è To prevent tampering with the transaction data. We highly recommend that you Verify the payment result from your backend.
</aside>

When the shopper returns to your app, make a **GET**  **`/v2.01/**ClientId**/<payInType>/**PayInId` request from your server to verify the result of the payment. (with respect to the payInType)

The success/failure callback will provide you with a PayIn type and PayIn to make the request.

<aside>
    <img src="https://www.notion.so/icons/square-alternate_gray.svg" alt="https://www.notion.so/icons/square-alternate_gray.svg" width="40px" /> **GET** /v2.01/`ClientId`/`Pa**yInType**`/`PayInId`

[See parameter details ‚Üí](https://preview-documentation.swarm.preprod.mangopay.com/docs/endpoints/direct-card-payins#create-card-registration)
</aside>

If the payment was successful you'll receive an¬†**SUCCEEDED** `status`.

## Customizing the Checkout  

### Branding

<Info>
    Every component on the screen is highly customizable via theme.xml or by adding it to the `PaymentFormView`
</Info>

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">mangopay_elementTopLabelColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_elementInputColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_elementInputHintColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_elementTopLabelSize</td>
            <td class="table-content">Dimension</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_elementTopLabel</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_buttonBackgroundColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_buttonTextColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_progressBarColor</td>
            <td class="table-content">Color</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_elementBorderLineType</td>
            <td class="table-content">Enum</td>
        </tr>
    </tbody>
</table>

```xml Example ‚Äì Theme
<style name="Theme.ShuFitness" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
        <!-- Primary brand color. -->
        <item name="colorPrimary">@color/shopping_primary</item>
        <item name="colorPrimaryVariant">@color/shopping_primary</item>
        <item name="colorOnPrimary">@color/white</item>

        <item name="mangopay_elementTopLabelColor">@color/black</item>
        <item name="mangopay_elementInputColor">@color/black</item>
        <item name="mangopay_elementTopLabelSize">@dimen/top_label_size</item>
        <item name="mangopay_elementInputHintColor">@color/black</item>
        <item name="mangopay_progressBarColor">@color/shopping_secondary</item>
    </style>
```  

You can add your theme to the `application` in `AndroidManifest.xml`.¬†  
```xml 
<application
    android:allowBackup="true"
    android:icon="@mipmap/ic_launcher"
    android:label="@string/app_name"
    android:roundIcon="@mipmap/ic_launcher_round"
    android:supportsRtl="true"
    android:theme="@style/Theme.ShuFitness">
```  

### Configuring the Google Pay button  

Configure the Google Pay button for your app in line with Google Pay‚Äôs <a href="https://developers.google.com/pay/api/android/guides/brand-guidelines" target="_blank">brand guidelines</a>.  
```kotlin Example ‚Äì Google Pay configuration
val paymentMethods = JSONArray().put(PaymentsUtil.baseCardPaymentMethod())
val gpayButtonOption = ButtonOptions.newBuilder()
       .setButtonTheme(ButtonConstants.ButtonTheme.LIGHT)
       .setButtonType(ButtonConstants.ButtonType.BUY)
       .setAllowedPaymentMethods(paymentMethods.toString())
       .setCornerRadius(10)
       .build()
```  

## Localization  

The Mangopay Checkout SDK allows you to localize language strings. 

<table>
    <thead>
        <tr>
            <th class="header">Property</th>
            <th class="header">Type</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="table-content">mangopay_elementTopLabel</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_buttonCheckoutText</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardNumberHint</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardNumberError</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardNameHint</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardNameError</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardMMYYHint</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardMMYYError</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardCVVHint</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_cardCVVError</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_orPayWithText</td>
            <td class="table-content">String</td>
        </tr>
        <tr>
            <td class="table-content">mangopay_sheetAppBarText</td>
            <td class="table-content">String</td>
        </tr>
    </tbody>
</table>
